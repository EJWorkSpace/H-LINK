<!doctype html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
  <meta charset="UTF-8"/>
  <title>í•œë¦¼ëŒ€ ê³µì§€ ëª¨ì•„ë³´ê¸°</title>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; }
    .topbar { display:flex; gap:8px; align-items:center; margin-bottom:16px; }
    .btn { padding:8px 12px; border:1px solid #ddd; background:#fff; border-radius:8px; cursor:pointer; }
    .btn:hover { background:#f6f6f6; }
    table { width:100%; border-collapse: collapse; }
    th, td { padding:10px 12px; border-bottom:1px solid #eee; vertical-align: top; }
    th { text-align:left; color:#666; font-weight:600; }
    .title { font-weight:600; }
    .tags { display:flex; flex-wrap:wrap; gap:6px; }
    .tag-chip { font-size:12px; padding:4px 8px; border:1px solid #ddd; border-radius:999px; background:#fafafa; }
    .summary { color:#333; }
    .link { color:#2563eb; text-decoration:none; }
    .link:hover { text-decoration:underline; }
    .muted { color:#9ca3af; }
    .actions { display:flex; gap:8px; }
  </style>
</head>
<body>

  <div class="topbar">
    <h2 style="margin:0;">ê³µì§€ ëª©ë¡</h2>

    <form th:action="@{/admin/sync}" method="post" style="margin-left:auto;">
      <button class="btn" type="submit">ğŸ”„ ìµœì‹  ê³µì§€ ë™ê¸°í™”</button>
    </form>

    <form th:action="@{/admin/analyze-missing}" method="post">
      <button class="btn" type="submit">ğŸ¤– ìš”ì•½ ì—†ëŠ” ê²ƒë§Œ ë¶„ì„</button>
    </form>
  </div>

  <table>
    <thead>
      <tr>
        <th style="width:34%;">ì œëª© / ë§í¬</th>
        <th style="width:18%;">ë¶„ë¥˜ / ë‚ ì§œ</th>
        <th style="width:30%;">ìš”ì•½</th>
        <th style="width:18%;">íƒœê·¸ / ì•¡ì…˜</th>
      </tr>
    </thead>
    <tbody>
      <tr th:each="n : ${notices}">
        <!-- ì œëª© / ë§í¬ -->
        <td>
          <div class="title" th:text="${n.title}">ì œëª©</div>
          <a class="link" th:href="${n.link}" target="_blank" rel="noreferrer">ì›ë¬¸ ë³´ê¸° â†—</a>
        </td>

        <!-- ì¹´í…Œê³ ë¦¬ / ë‚ ì§œ -->
        <td>
          <div th:text="${(n.category != null and #strings.trim(n.category) != '') ? n.category : 'ë¯¸ë¶„ë¥˜'}">ì¥í•™</div>

          <div class="muted"
               th:text="${n.date != null ? #temporals.format(n.date, 'yyyy-MM-dd HH:mm') : 'ë‚ ì§œ ì—†ìŒ'}">
            2025-10-29
          </div>

          <div class="muted" th:if="${n.deadline != null}">
            ë§ˆê°:
            <span th:text="${#temporals.format(n.deadline, 'yyyy-MM-dd HH:mm')}">2025-11-05</span>
          </div>

          <div class="muted" th:if="${n.aiUpdatedAt != null}">
            ë¶„ì„:
            <span th:text="${#temporals.format(n.aiUpdatedAt, 'yyyy-MM-dd HH:mm')}">2025-10-30</span>
          </div>
        </td>

        <!-- ìš”ì•½ -->
        <td class="summary"
            th:text="${(n.summary != null and #strings.trim(n.summary) != '') ? n.summary : 'ìš”ì•½ ì—†ìŒ (ë¶„ì„ ë²„íŠ¼ì„ ëˆŒëŸ¬ ìƒì„±)'}">
          ìš”ì•½ ì—†ìŒ
        </td>

        <!-- íƒœê·¸ / ì•¡ì…˜ -->
        <td>
          <div class="tags">
            <!-- List<String> tags ê¸°ì¤€ -->
            <span class="tag-chip"
                  th:each="t : ${n.tags}"
                  th:if="${t != null and #strings.trim(t) != ''}"
                  th:text="${#strings.trim(t)}">íƒœê·¸</span>
          </div>

          <div class="actions" style="margin-top:8px;">
            <!-- ì•ˆì „í•œ ê²½ë¡œ ë³€ìˆ˜ ë°”ì¸ë”© -->
            <form th:action="@{/notices/{id}/analyze(id=${n.id})}" method="post">
              <button class="btn" type="submit">ì´ ê³µì§€ ìš”ì•½</button>
            </form>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

</body>
</html>